
<!DOCTYPE html>


<html lang="en" data-content_root="../../" data-theme="dark">

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>nnsight.intervention &#8212; nnsight</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "dark";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "dark";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../_static/documentation_options.js?v=187304be"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'documentation/intervention';</script>
    <script src="../../_static/js/custom.js?v=1e4be224"></script>
    <script src="../../_static/js/code.js?v=34343d0c"></script>
    <link rel="icon" href="../../_static/icon.ico"/>
    <link rel="author" title="About these documents" href="../../about/" />
    <link rel="index" title="Index" href="../../genindex/" />
    <link rel="search" title="Search" href="../../search/" />
    <link rel="next" title="nnsight.schema" href="../schema/" />
    <link rel="prev" title="nnsight.tracing" href="../tracing/" />

  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
<link href="../../_static/css/custom.css?v=1752690525" rel="stylesheet" type="text/css" />
<link href="../../_static/css/home.css?v=1752690525" rel="stylesheet" type="text/css" />

  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="dark">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search/"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class=" navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../">
  
  
  
  
  
    
    
    
    <img src="../../_static/nnsight_logo.svg" class="logo__image only-dark" alt="nnsight - Home"/>
    <img src="../../_static/nnsight_logo.svg" class="logo__image only-light pst-js-only" alt="nnsight - Home"/>
  
  
</a></div>
    
  </div>
  
  <div class=" navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../start/">
    Getting Started
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../">
    Documentation
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../features/">
    Features
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../tutorials/">
    Tutorials
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../about/">
    About
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item"><script>
    fetch("https://ndif.dev/ping")
        .then((response) => {
            if (response.status == 200) {
                Array.from(document.getElementsByClassName("ndif")).forEach((ndifElement) => {
                    Array.from(ndifElement.getElementsByTagName('span')).forEach((spanElement) => {
                        spanElement.style.setProperty('color', '#66800b', 'important');
                    });
                });
            }
            else {
                Array.from(document.getElementsByClassName("ndif")).forEach((ndifElement) => {
                    Array.from(ndifElement.getElementsByTagName('span')).forEach((spanElement) => {
                        spanElement.style.setProperty('color', '#af3029', 'important');
                    });
                });
                var statusIcon = document.querySelector('.ndif .fa-circle-check');
                if (statusIcon) {
                    // not here
                    statusIcon.classList.replace('fa-circle-check', 'fa-circle-xmark'); 
                }
            }
        })
        .catch((response) => {
            Array.from(document.getElementsByClassName("ndif")).forEach((ndifElement) => {
                Array.from(ndifElement.getElementsByTagName('span')).forEach((spanElement) => {
                    spanElement.style.setProperty('color', '#af3029', 'important');
                });
            });
            var statusIcon = document.querySelector('.ndif .fa-circle-check');
            if (statusIcon) {
                statusIcon.classList.replace('fa-circle-check', 'fa-circle-xmark');
            }
        })
</script></div>
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
            
          
          
          
          
          
          
          
          
          
          <a href="/status" title="Status: Unknown" class="ndif" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-solid fa-circle-check fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Status: Unknown</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/ndif-team/nnsight" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://discuss.ndif.us/" title="Forum" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-discourse fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Forum</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://forms.gle/1Y6myaXYzSh3oHf56" title="Discord" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-discord fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Discord</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../start/">
    Getting Started
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../">
    Documentation
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../features/">
    Features
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../tutorials/">
    Tutorials
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../about/">
    About
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item"><script>
    fetch("https://ndif.dev/ping")
        .then((response) => {
            if (response.status == 200) {
                Array.from(document.getElementsByClassName("ndif")).forEach((ndifElement) => {
                    Array.from(ndifElement.getElementsByTagName('span')).forEach((spanElement) => {
                        spanElement.style.setProperty('color', '#66800b', 'important');
                    });
                });
            }
            else {
                Array.from(document.getElementsByClassName("ndif")).forEach((ndifElement) => {
                    Array.from(ndifElement.getElementsByTagName('span')).forEach((spanElement) => {
                        spanElement.style.setProperty('color', '#af3029', 'important');
                    });
                });
                var statusIcon = document.querySelector('.ndif .fa-circle-check');
                if (statusIcon) {
                    // not here
                    statusIcon.classList.replace('fa-circle-check', 'fa-circle-xmark'); 
                }
            }
        })
        .catch((response) => {
            Array.from(document.getElementsByClassName("ndif")).forEach((ndifElement) => {
                Array.from(ndifElement.getElementsByTagName('span')).forEach((spanElement) => {
                    spanElement.style.setProperty('color', '#af3029', 'important');
                });
            });
            var statusIcon = document.querySelector('.ndif .fa-circle-check');
            if (statusIcon) {
                statusIcon.classList.replace('fa-circle-check', 'fa-circle-xmark');
            }
        })
</script></div>
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
            
          
          
          
          
          
          
          
          
          
          <a href="/status" title="Status: Unknown" class="ndif" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-solid fa-circle-check fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Status: Unknown</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/ndif-team/nnsight" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://discuss.ndif.us/" title="Forum" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-discourse fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Forum</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://forms.gle/1Y6myaXYzSh3oHf56" title="Discord" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-discord fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Discord</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../modeling/">nnsight.modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tracing/">nnsight.tracing</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">nnsight.intervention</a></li>
<li class="toctree-l1"><a class="reference internal" href="../schema/">nnsight.schema</a></li>
<li class="toctree-l1"><a class="reference internal" href="../util/">nnsight.util</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../" class="nav-link">Documentation</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">nnsight.intervention</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="module-nnsight.intervention">
<span id="nnsight-intervention"></span><h1>nnsight.intervention<a class="headerlink" href="#module-nnsight.intervention" title="Link to this heading">#</a></h1>
<p>The <cite>intervention</cite> module extends the <cite>tracing</cite> module to add PyTorch specific interventions to a given computation graph.
It defines its own: protocols, contexts, backends and graph primitives to achieve this.</p>
<dl class="py class" id="module-nnsight.intervention.protocols.entrypoint">
<span id="module-nnsight.intervention.protocols"></span><dt class="sig sig-object py" id="nnsight.intervention.protocols.entrypoint.EntryPoint">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">nnsight.intervention.protocols.entrypoint.</span></span><span class="sig-name descname"><span class="pre">EntryPoint</span></span><a class="reference internal" href="../../_modules/nnsight/intervention/protocols/entrypoint/#EntryPoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnsight.intervention.protocols.entrypoint.EntryPoint" title="Link to this definition">#</a></dt>
<dd><p>An EntryPoint Protocol should have its value set manually outside of normal graph execution.
This makes these type of Nodes special and are handled differently in a variety of cases.
Subclasses EntryPoint informs those cases to handle it differently.
Examples are InterventionProtocol and GradProtocol.</p>
</dd></dl>

<dl class="py class" id="module-nnsight.intervention.protocols.grad">
<dt class="sig sig-object py" id="nnsight.intervention.protocols.grad.GradProtocol">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">nnsight.intervention.protocols.grad.</span></span><span class="sig-name descname"><span class="pre">GradProtocol</span></span><a class="reference internal" href="../../_modules/nnsight/intervention/protocols/grad/#GradProtocol"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnsight.intervention.protocols.grad.GradProtocol" title="Link to this definition">#</a></dt>
<dd><p>Protocol which adds a backwards hook via .register_hook() to a Tensor. The hook injects the gradients into the node’s value on hook execution.
Nodes created via this protocol are relative to the next time .backward() was called during tracing allowing separate .grads to reference separate backwards passes:</p>
<p>Uses an attachment to store number of times .backward() has been called during tracing so a given .grad hook is only value injected at the appropriate backwards pass.</p>
<dl class="py method">
<dt class="sig sig-object py" id="nnsight.intervention.protocols.grad.GradProtocol.style">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">style</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/nnsight/intervention/protocols/grad/#GradProtocol.style"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnsight.intervention.protocols.grad.GradProtocol.style" title="Link to this definition">#</a></dt>
<dd><p>Visualization style for this protocol node.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>dictionary style.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>Dict</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class" id="module-nnsight.intervention.protocols.intervention">
<dt class="sig sig-object py" id="nnsight.intervention.protocols.intervention.InterventionProtocol">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">nnsight.intervention.protocols.intervention.</span></span><span class="sig-name descname"><span class="pre">InterventionProtocol</span></span><a class="reference internal" href="../../_modules/nnsight/intervention/protocols/intervention/#InterventionProtocol"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnsight.intervention.protocols.intervention.InterventionProtocol" title="Link to this definition">#</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="nnsight.intervention.protocols.intervention.InterventionProtocol.intervene">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">intervene</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">activations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">module_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">module</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interleaver</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#nnsight.intervention.interleaver.Interleaver" title="nnsight.intervention.interleaver.Interleaver"><span class="pre">Interleaver</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnsight/intervention/protocols/intervention/#InterventionProtocol.intervene"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnsight.intervention.protocols.intervention.InterventionProtocol.intervene" title="Link to this definition">#</a></dt>
<dd><p>Entry to intervention graph. This should be hooked to all modules involved in the intervention graph.</p>
<p>Forms the current module_path key in the form of &lt;module path&gt;.&lt;output/input&gt;
Checks the graphs InterventionProtocol attachment attribute for this key.
If exists, value is a list of (start:int, end:int) subgraphs to iterate through.
Node args for intervention type nodes should be <code class="docutils literal notranslate"><span class="pre">[module_path,</span> <span class="pre">(batch_start,</span> <span class="pre">batch_size),</span> <span class="pre">iteration]</span></code>.
Checks and updates the counter (number of times this module has been called for this Node) for the given intervention node. If count is not ready yet compared to the iteration, continue.
Using batch_size and batch_start, apply torch.narrow to tensors in activations to select
only batch indexed tensors relevant to this intervention node. Sets the value of a node
using the indexed values. Using torch.narrow returns a view of the tensors as opposed to a copy allowing
subsequent downstream nodes to make edits to the values only in the relevant tensors, and have it update the original
tensors. This both prevents interventions from effecting bathes outside their preview and allows edits
to the output from downstream intervention nodes in the graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>activations</strong> (<em>Any</em>) – Either the inputs or outputs of a torch module.</p></li>
<li><p><strong>module_path</strong> (<em>str</em>) – Module path of the current relevant module relative to the root model.</p></li>
<li><p><strong>key</strong> (<em>str</em>) – Key denoting either “input” or “output” of module.</p></li>
<li><p><strong>intervention_handler</strong> (<em>InterventionHandler</em>) – Handler object that stores the intervention graph and keeps track of module call count.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The activations, potentially modified by the intervention graph.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Any</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nnsight.intervention.protocols.intervention.InterventionProtocol.style">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">style</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/nnsight/intervention/protocols/intervention/#InterventionProtocol.style"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnsight.intervention.protocols.intervention.InterventionProtocol.style" title="Link to this definition">#</a></dt>
<dd><p>Visualization style for this protocol node.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>dictionary style.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>Dict</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class" id="module-nnsight.intervention.protocols.module">
<dt class="sig sig-object py" id="nnsight.intervention.protocols.module.ApplyModuleProtocol">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">nnsight.intervention.protocols.module.</span></span><span class="sig-name descname"><span class="pre">ApplyModuleProtocol</span></span><a class="reference internal" href="../../_modules/nnsight/intervention/protocols/module/#ApplyModuleProtocol"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnsight.intervention.protocols.module.ApplyModuleProtocol" title="Link to this definition">#</a></dt>
<dd><p>Protocol that references some root model, and calls its .forward() method given some input.
Using .forward() vs .__call__() means it wont trigger hooks.
Uses an attachment to the Graph to store the model.</p>
<dl class="py method">
<dt class="sig sig-object py" id="nnsight.intervention.protocols.module.ApplyModuleProtocol.add">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">add</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">graph</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#nnsight.intervention.graph.graph.InterventionGraph" title="nnsight.intervention.graph.graph.InterventionGraph"><span class="pre">InterventionGraph</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">module_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hook</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="../../_modules/nnsight/intervention/protocols/module/#ApplyModuleProtocol.add"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnsight.intervention.protocols.module.ApplyModuleProtocol.add" title="Link to this definition">#</a></dt>
<dd><p>Creates and adds an ApplyModuleProtocol to the Graph.
Assumes the attachment has already been added via ApplyModuleProtocol.set_module().</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>graph</strong> (<a class="reference internal" href="../tracing/#nnsight.tracing.graph.graph.Graph" title="nnsight.tracing.graph.graph.Graph"><em>Graph</em></a>) – Graph to add the Protocol to.</p></li>
<li><p><strong>module_path</strong> (<em>str</em>) – Module path (model.module1.module2 etc), of module to apply from the root module.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>ApplyModule Proxy.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#nnsight.intervention.graph.proxy.InterventionProxy" title="nnsight.intervention.graph.proxy.InterventionProxy">InterventionProxy</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nnsight.intervention.protocols.module.ApplyModuleProtocol.execute">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">execute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#nnsight.intervention.graph.node.InterventionNode" title="nnsight.intervention.graph.node.InterventionNode"><span class="pre">InterventionNode</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/nnsight/intervention/protocols/module/#ApplyModuleProtocol.execute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnsight.intervention.protocols.module.ApplyModuleProtocol.execute" title="Link to this definition">#</a></dt>
<dd><p>Executes the ApplyModuleProtocol on Node.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>node</strong> (<a class="reference internal" href="../tracing/#nnsight.tracing.graph.node.Node" title="nnsight.tracing.graph.node.Node"><em>Node</em></a>) – ApplyModule Node.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nnsight.intervention.protocols.module.ApplyModuleProtocol.style">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">style</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/nnsight/intervention/protocols/module/#ApplyModuleProtocol.style"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnsight.intervention.protocols.module.ApplyModuleProtocol.style" title="Link to this definition">#</a></dt>
<dd><p>Visualization style for this protocol node.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>dictionary style.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>Dict</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class" id="module-nnsight.intervention.contexts.editing">
<span id="module-nnsight.intervention.contexts"></span><span id="module-nnsight.intervention.protocols.swap"></span><dt class="sig sig-object py" id="nnsight.intervention.contexts.editing.EditingTracer">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">nnsight.intervention.contexts.editing.</span></span><span class="sig-name descname"><span class="pre">EditingTracer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#nnsight.intervention.base.NNsight" title="nnsight.intervention.base.NNsight"><span class="pre">NNsight</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnsight/intervention/contexts/editing/#EditingTracer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnsight.intervention.contexts.editing.EditingTracer" title="Link to this definition">#</a></dt>
<dd><p>The <cite>EditingTracer</cite> exists because we want to return the edited model from __enter__ not the Tracer itself
While were here we might as well force the backend to be <cite>EditingBackend</cite></p>
</dd></dl>

<p id="module-nnsight.intervention.contexts.globals">Global patching allows us to add un-traceable operations to nnsight by replacing them with ones that use the GLOBAL_TRACING_CONTEXT to add the operation to the current graph.</p>
<dl class="py class">
<dt class="sig sig-object py" id="nnsight.intervention.contexts.globals.GlobalInterventionTracingContext">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">nnsight.intervention.contexts.globals.</span></span><span class="sig-name descname"><span class="pre">GlobalInterventionTracingContext</span></span><a class="reference internal" href="../../_modules/nnsight/intervention/contexts/globals/#GlobalInterventionTracingContext"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnsight.intervention.contexts.globals.GlobalInterventionTracingContext" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py class" id="module-nnsight.intervention.contexts.interleaving">
<dt class="sig sig-object py" id="nnsight.intervention.contexts.interleaving.InterleavingTracer">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">nnsight.intervention.contexts.interleaving.</span></span><span class="sig-name descname"><span class="pre">InterleavingTracer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#nnsight.intervention.base.NNsight" title="nnsight.intervention.base.NNsight"><span class="pre">NNsight</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backend</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Backend</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">GraphType</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnsight/intervention/contexts/interleaving/#InterleavingTracer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnsight.intervention.contexts.interleaving.InterleavingTracer" title="Link to this definition">#</a></dt>
<dd><p>This is the Tracer type that actually interleaves an <cite>InterventionGraph</cite> with a PyTorch model upon execute.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="nnsight.intervention.contexts.interleaving.InterleavingTracer._model">
<span class="sig-name descname"><span class="pre">_model</span></span><a class="headerlink" href="#nnsight.intervention.contexts.interleaving.InterleavingTracer._model" title="Link to this definition">#</a></dt>
<dd><p>NNsight model.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#nnsight.intervention.base.NNsight" title="nnsight.intervention.base.NNsight">NNsight</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="nnsight.intervention.contexts.interleaving.InterleavingTracer.invoker">
<span class="sig-name descname"><span class="pre">invoker</span></span><a class="headerlink" href="#nnsight.intervention.contexts.interleaving.InterleavingTracer.invoker" title="Link to this definition">#</a></dt>
<dd><p>Current open invoker so we can prevent opening two at the same time.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#nnsight.intervention.contexts.invoker.Invoker" title="nnsight.intervention.contexts.invoker.Invoker">Invoker</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="nnsight.intervention.contexts.interleaving.InterleavingTracer.args">
<span class="sig-name descname"><span class="pre">args</span></span><a class="headerlink" href="#nnsight.intervention.contexts.interleaving.InterleavingTracer.args" title="Link to this definition">#</a></dt>
<dd><p>Positional arguments. First is which method to interleave with and subsequent args are invoker inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[…]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="nnsight.intervention.contexts.interleaving.InterleavingTracer.kwargs">
<span class="sig-name descname"><span class="pre">kwargs</span></span><a class="headerlink" href="#nnsight.intervention.contexts.interleaving.InterleavingTracer.kwargs" title="Link to this definition">#</a></dt>
<dd><p>Keyword arguments passed to the method to interleave. These are “global” keyword arguments for our chosen methof
while kwargs for a given invoker are used for preprocessing the invoker input.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str,Any]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nnsight.intervention.contexts.interleaving.InterleavingTracer.invoke">
<span class="sig-name descname"><span class="pre">invoke</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#nnsight.intervention.contexts.invoker.Invoker" title="nnsight.intervention.contexts.invoker.Invoker"><span class="pre">Invoker</span></a></span></span><a class="reference internal" href="../../_modules/nnsight/intervention/contexts/interleaving/#InterleavingTracer.invoke"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnsight.intervention.contexts.interleaving.InterleavingTracer.invoke" title="Link to this definition">#</a></dt>
<dd><p>Create an Invoker context for a given input.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>Exception</strong> – If an Invoker context is already open</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Invoker.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#nnsight.intervention.contexts.invoker.Invoker" title="nnsight.intervention.contexts.invoker.Invoker">Invoker</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class" id="module-nnsight.intervention.contexts.invoker">
<dt class="sig sig-object py" id="nnsight.intervention.contexts.invoker.Invoker">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">nnsight.intervention.contexts.invoker.</span></span><span class="sig-name descname"><span class="pre">Invoker</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tracer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#nnsight.intervention.contexts.interleaving.InterleavingTracer" title="nnsight.intervention.contexts.interleaving.InterleavingTracer"><span class="pre">InterleavingTracer</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scan</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnsight/intervention/contexts/invoker/#Invoker"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnsight.intervention.contexts.invoker.Invoker" title="Link to this definition">#</a></dt>
<dd><p>An Invoker is meant to work in tandem with a <code class="xref py py-class docutils literal notranslate"><span class="pre">nnsight.intervention.contexts.InterleavingTracer</span></code> to enter input and manage intervention tracing.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="nnsight.intervention.contexts.invoker.Invoker.tracer">
<span class="sig-name descname"><span class="pre">tracer</span></span><a class="headerlink" href="#nnsight.intervention.contexts.invoker.Invoker.tracer" title="Link to this definition">#</a></dt>
<dd><p>Tracer object to enter input and manage context.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nnsight.contexts.Tracer.Tracer</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="nnsight.intervention.contexts.invoker.Invoker.inputs">
<span class="sig-name descname"><span class="pre">inputs</span></span><a class="headerlink" href="#nnsight.intervention.contexts.invoker.Invoker.inputs" title="Link to this definition">#</a></dt>
<dd><p>Initially entered inputs, then post-processed inputs from model’s ._prepare_inputs(…) method.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[Any]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="nnsight.intervention.contexts.invoker.Invoker.scan">
<span class="sig-name descname"><span class="pre">scan</span></span><a class="headerlink" href="#nnsight.intervention.contexts.invoker.Invoker.scan" title="Link to this definition">#</a></dt>
<dd><p>If to execute the model using <cite>FakeTensor</cite> in order to update the potential sizes/dtypes of all modules’ Envoys’ inputs/outputs as well as validate things work correctly.
Scanning is not free computation wise so you may want to turn this to false when running in a loop.
When making interventions, you made get shape errors if scan is false as it validates operations based on shapes so
for looped calls where shapes are consistent, you may want to have scan=True for the first loop. Defaults to False.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="nnsight.intervention.contexts.invoker.Invoker.kwargs">
<span class="sig-name descname"><span class="pre">kwargs</span></span><a class="headerlink" href="#nnsight.intervention.contexts.invoker.Invoker.kwargs" title="Link to this definition">#</a></dt>
<dd><p>Keyword arguments passed to the model’s _prepare_inputs method.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str,Any]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="nnsight.intervention.contexts.invoker.Invoker.scanning">
<span class="sig-name descname"><span class="pre">scanning</span></span><a class="headerlink" href="#nnsight.intervention.contexts.invoker.Invoker.scanning" title="Link to this definition">#</a></dt>
<dd><p>If currently scanning.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class" id="module-nnsight.intervention.contexts.local">
<dt class="sig sig-object py" id="nnsight.intervention.contexts.local.LocalContext">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">nnsight.intervention.contexts.local.</span></span><span class="sig-name descname"><span class="pre">LocalContext</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">*args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backend:</span> <span class="pre">~nnsight.tracing.backends.base.Backend</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent:</span> <span class="pre">~nnsight.tracing.graph.graph.GraphType</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph:</span> <span class="pre">~nnsight.tracing.graph.graph.GraphType</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph_class:</span> <span class="pre">~typing.Type[~nnsight.tracing.graph.graph.SubGraph]</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'nnsight.tracing.graph.graph.SubGraph'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_class:</span> <span class="pre">~typing.Type[~nnsight.tracing.graph.node.NodeType]</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'nnsight.tracing.graph.node.Node'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proxy_class:</span> <span class="pre">~typing.Type[~nnsight.tracing.graph.proxy.ProxyType]</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'nnsight.tracing.graph.proxy.Proxy'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnsight/intervention/contexts/local/#LocalContext"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnsight.intervention.contexts.local.LocalContext" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="nnsight.intervention.contexts.local.RemoteContext">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">nnsight.intervention.contexts.local.</span></span><span class="sig-name descname"><span class="pre">RemoteContext</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">*args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backend:</span> <span class="pre">~nnsight.tracing.backends.base.Backend</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent:</span> <span class="pre">~nnsight.tracing.graph.graph.GraphType</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph:</span> <span class="pre">~nnsight.tracing.graph.graph.GraphType</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph_class:</span> <span class="pre">~typing.Type[~nnsight.tracing.graph.graph.SubGraph]</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'nnsight.tracing.graph.graph.SubGraph'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_class:</span> <span class="pre">~typing.Type[~nnsight.tracing.graph.node.NodeType]</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'nnsight.tracing.graph.node.Node'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proxy_class:</span> <span class="pre">~typing.Type[~nnsight.tracing.graph.proxy.ProxyType]</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'nnsight.tracing.graph.proxy.Proxy'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnsight/intervention/contexts/local/#RemoteContext"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnsight.intervention.contexts.local.RemoteContext" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py class" id="module-nnsight.intervention.contexts.session">
<dt class="sig sig-object py" id="nnsight.intervention.contexts.session.Session">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">nnsight.intervention.contexts.session.</span></span><span class="sig-name descname"><span class="pre">Session</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#nnsight.intervention.base.NNsight" title="nnsight.intervention.base.NNsight"><span class="pre">NNsight</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">validate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnsight/intervention/contexts/session/#Session"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnsight.intervention.contexts.session.Session" title="Link to this definition">#</a></dt>
<dd><p>A Session simply allows grouping multiple Tracers in one computation graph.</p>
</dd></dl>

<dl class="py class" id="module-nnsight.intervention.contexts.tracer">
<dt class="sig sig-object py" id="nnsight.intervention.contexts.tracer.InterventionTracer">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">nnsight.intervention.contexts.tracer.</span></span><span class="sig-name descname"><span class="pre">InterventionTracer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnsight/intervention/contexts/tracer/#InterventionTracer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnsight.intervention.contexts.tracer.InterventionTracer" title="Link to this definition">#</a></dt>
<dd><p>Extension of base Tracer to add additional intervention functionality and type hinting for intervention proxies.</p>
<dl class="py method">
<dt class="sig sig-object py" id="nnsight.intervention.contexts.tracer.InterventionTracer.style">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">style</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/nnsight/intervention/contexts/tracer/#InterventionTracer.style"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnsight.intervention.contexts.tracer.InterventionTracer.style" title="Link to this definition">#</a></dt>
<dd><p>Visualization style for this protocol node.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>dictionary style.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>Dict</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class" id="module-nnsight.intervention.backends.editing">
<span id="module-nnsight.intervention.backends"></span><dt class="sig sig-object py" id="nnsight.intervention.backends.editing.EditingBackend">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">nnsight.intervention.backends.editing.</span></span><span class="sig-name descname"><span class="pre">EditingBackend</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#nnsight.intervention.base.NNsight" title="nnsight.intervention.base.NNsight"><span class="pre">NNsight</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnsight/intervention/backends/editing/#EditingBackend"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnsight.intervention.backends.editing.EditingBackend" title="Link to this definition">#</a></dt>
<dd><p>Backend to set the default graph to the current InterventionGraph. Assumes the final Node is an InterleavingTracer.</p>
</dd></dl>

<dl class="py class" id="module-nnsight.intervention.backends.remote">
<dt class="sig sig-object py" id="nnsight.intervention.backends.remote.RemoteBackend">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">nnsight.intervention.backends.remote.</span></span><span class="sig-name descname"><span class="pre">RemoteBackend</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">host</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blocking</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">job_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ssl</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">api_key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnsight/intervention/backends/remote/#RemoteBackend"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnsight.intervention.backends.remote.RemoteBackend" title="Link to this definition">#</a></dt>
<dd><p>Backend to execute a context object via a remote service.</p>
<p>Context object must inherit from RemoteMixin and implement its methods.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="nnsight.intervention.backends.remote.RemoteBackend.url">
<span class="sig-name descname"><span class="pre">url</span></span><a class="headerlink" href="#nnsight.intervention.backends.remote.RemoteBackend.url" title="Link to this definition">#</a></dt>
<dd><p>Remote host url. Defaults to that set in CONFIG.API.HOST.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nnsight.intervention.backends.remote.RemoteBackend.blocking_request">
<span class="sig-name descname"><span class="pre">blocking_request</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">graph</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../tracing/#nnsight.tracing.graph.graph.Graph" title="nnsight.tracing.graph.graph.Graph"><span class="pre">Graph</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/nnsight/intervention/backends/remote/#RemoteBackend.blocking_request"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnsight.intervention.backends.remote.RemoteBackend.blocking_request" title="Link to this definition">#</a></dt>
<dd><p>Send intervention request to the remote service while waiting for updates via websocket.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>request</strong> (<em>RequestModel</em>) – Request.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nnsight.intervention.backends.remote.RemoteBackend.get_response">
<span class="sig-name descname"><span class="pre">get_response</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/nnsight/intervention/backends/remote/#RemoteBackend.get_response"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnsight.intervention.backends.remote.RemoteBackend.get_response" title="Link to this definition">#</a></dt>
<dd><p>Retrieves and handles the response object from the remote endpoint.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>Exception</strong> – If there was a status code other than 200 for the response.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Response.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(ResponseModel)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nnsight.intervention.backends.remote.RemoteBackend.handle_response">
<span class="sig-name descname"><span class="pre">handle_response</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">response</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ResponseModel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../tracing/#nnsight.tracing.graph.graph.Graph" title="nnsight.tracing.graph.graph.Graph"><span class="pre">Graph</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/nnsight/intervention/backends/remote/#RemoteBackend.handle_response"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnsight.intervention.backends.remote.RemoteBackend.handle_response" title="Link to this definition">#</a></dt>
<dd><p>Handles incoming response data.</p>
<p>Logs the response object.
If the job is completed, retrieve and stream the result from the remote endpoint.
Use torch.load to decode and load the <cite>ResultModel</cite> into memory.
Use the backend object’s .handle_result method to handle the decoded result.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>response</strong> (<em>Any</em>) – Json data to concert to <cite>ResponseModel</cite></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Exception</strong> – If the job’s status is <cite>ResponseModel.JobStatus.ERROR</cite></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>ResponseModel.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>ResponseModel</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nnsight.intervention.backends.remote.RemoteBackend.non_blocking_request">
<span class="sig-name descname"><span class="pre">non_blocking_request</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">graph</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../tracing/#nnsight.tracing.graph.graph.Graph" title="nnsight.tracing.graph.graph.Graph"><span class="pre">Graph</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnsight/intervention/backends/remote/#RemoteBackend.non_blocking_request"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnsight.intervention.backends.remote.RemoteBackend.non_blocking_request" title="Link to this definition">#</a></dt>
<dd><p>Send intervention request to the remote service if request provided. Otherwise get job status.</p>
<p>Sets CONFIG.API.JOB_ID on initial request as to later get the status of said job.</p>
<p>When job is completed, clear CONFIG.API.JOB_ID to request a new job.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>request</strong> (<em>RequestModel</em>) – Request if submitting a new request. Defaults to None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nnsight.intervention.backends.remote.RemoteBackend.stream_send">
<span class="sig-name descname"><span class="pre">stream_send</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">job_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sio</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">SimpleClient</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnsight/intervention/backends/remote/#RemoteBackend.stream_send"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnsight.intervention.backends.remote.RemoteBackend.stream_send" title="Link to this definition">#</a></dt>
<dd><p>Upload some value to the remote service for some job id.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>value</strong> (<em>Any</em>) – Value to upload</p></li>
<li><p><strong>job_id</strong> (<em>str</em>) – Job id.</p></li>
<li><p><strong>sio</strong> (<em>socketio.SimpleClient</em>) – Connected websocket client.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nnsight.intervention.backends.remote.RemoteBackend.submit_request">
<span class="sig-name descname"><span class="pre">submit_request</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bytes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">headers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ResponseModel</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/nnsight/intervention/backends/remote/#RemoteBackend.submit_request"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnsight.intervention.backends.remote.RemoteBackend.submit_request" title="Link to this definition">#</a></dt>
<dd><p>Sends request to the remote endpoint and handles the response object.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>Exception</strong> – If there was a status code other than 200 for the response.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Response.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(ResponseModel)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class" id="module-nnsight.intervention.graph.graph">
<span id="module-nnsight.intervention.graph"></span><dt class="sig sig-object py" id="nnsight.intervention.graph.graph.InterventionGraph">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">nnsight.intervention.graph.graph.</span></span><span class="sig-name descname"><span class="pre">InterventionGraph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#nnsight.intervention.base.NNsight" title="nnsight.intervention.base.NNsight"><span class="pre">NNsight</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnsight/intervention/graph/graph/#InterventionGraph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnsight.intervention.graph.graph.InterventionGraph" title="Link to this definition">#</a></dt>
<dd><p>The <cite>InterventionGraph</cite> is the special <cite>SubGraph</cite> type that handles the complex intervention operations a user wants to make during interleaving.
We need to <cite>.compile()</cite> it before execution to determine how to execute interventions appropriately.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="nnsight.intervention.graph.graph.InterventionGraph.model">
<span class="sig-name descname"><span class="pre">model</span></span><a class="headerlink" href="#nnsight.intervention.graph.graph.InterventionGraph.model" title="Link to this definition">#</a></dt>
<dd><p>NNsight model.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#nnsight.intervention.base.NNsight" title="nnsight.intervention.base.NNsight">NNsight</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="nnsight.intervention.graph.graph.InterventionGraph.interventions">
<span class="sig-name descname"><span class="pre">interventions</span></span><a class="headerlink" href="#nnsight.intervention.graph.graph.InterventionGraph.interventions" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="nnsight.intervention.graph.graph.InterventionGraph.grad_subgraph">
<span class="sig-name descname"><span class="pre">grad_subgraph</span></span><a class="headerlink" href="#nnsight.intervention.graph.graph.InterventionGraph.grad_subgraph" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="nnsight.intervention.graph.graph.InterventionGraph.compiled">
<span class="sig-name descname"><span class="pre">compiled</span></span><a class="headerlink" href="#nnsight.intervention.graph.graph.InterventionGraph.compiled" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="nnsight.intervention.graph.graph.InterventionGraph.call_counter">
<span class="sig-name descname"><span class="pre">call_counter</span></span><a class="headerlink" href="#nnsight.intervention.graph.graph.InterventionGraph.call_counter" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="nnsight.intervention.graph.graph.InterventionGraph.deferred">
<span class="sig-name descname"><span class="pre">deferred</span></span><a class="headerlink" href="#nnsight.intervention.graph.graph.InterventionGraph.deferred" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nnsight.intervention.graph.graph.InterventionGraph.clean">
<span class="sig-name descname"><span class="pre">clean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnsight/intervention/graph/graph/#InterventionGraph.clean"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnsight.intervention.graph.graph.InterventionGraph.clean" title="Link to this definition">#</a></dt>
<dd><p>Cleans up dependencies of <cite>Node`s so their values are appropriately memory managed.
Cleans all `Node`s from start to end regardless if they are on this `Graph</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>start</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em><em>, </em><em>optional</em>) – <cite>Node</cite> index to start cleaning up from. Defaults to None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nnsight.intervention.graph.graph.InterventionGraph.cleanup">
<span class="sig-name descname"><span class="pre">cleanup</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/nnsight/intervention/graph/graph/#InterventionGraph.cleanup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnsight.intervention.graph.graph.InterventionGraph.cleanup" title="Link to this definition">#</a></dt>
<dd><p>Because some modules may be executed more than once, and to accommodate memory management just like a loop,
intervention graph sections defer updating the remaining listeners of Nodes if this is not the last time this section will be executed.
If we never knew it was the last time, there may still be deferred sections after execution.
These will be leftover in graph.deferred, and therefore we need to update their dependencies.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nnsight.intervention.graph.graph.InterventionGraph.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_graph</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Self</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">GraphType</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">memo</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">NodeType</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="../../_modules/nnsight/intervention/graph/graph/#InterventionGraph.copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnsight.intervention.graph.graph.InterventionGraph.copy" title="Link to this definition">#</a></dt>
<dd><p>Creates a shallow copy of this SubGraph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>new_graph</strong> (<em>Optional</em><em>[</em><a class="reference internal" href="../tracing/#nnsight.tracing.graph.graph.SubGraph" title="nnsight.tracing.graph.graph.SubGraph"><em>SubGraph</em></a><em>[</em><em>NodeType</em><em>, </em><em>ProxyType</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – SubGraph to copy into. Defaults to None and creates a new SubGraph of the same type.</p></li>
<li><p><strong>parent</strong> (<em>Optional</em><em>[</em><a class="reference internal" href="../tracing/#nnsight.tracing.graph.graph.Graph" title="nnsight.tracing.graph.graph.Graph"><em>Graph</em></a><em>[</em><em>NodeType</em><em>, </em><em>ProxyType</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – Parent graph. Defaults to None and will create a root <cite>Graph</cite> as the parent.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>New graph.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Self</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nnsight.intervention.graph.graph.InterventionGraph.count">
<span class="sig-name descname"><span class="pre">count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iteration</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">slice</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="../../_modules/nnsight/intervention/graph/graph/#InterventionGraph.count"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnsight.intervention.graph.graph.InterventionGraph.count" title="Link to this definition">#</a></dt>
<dd><p>Increments the count of times a given Intervention Node has tried to be executed and returns if the Node is ready and if it needs to be deferred.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index</strong> (<em>int</em>) – Index of intervention node to return count for.</p></li>
<li><p><strong>iteration</strong> (<em>Union</em><em>[</em><em>int</em><em>, </em><em>List</em><em>[</em><em>int</em><em>]</em><em>, </em><em>slice</em><em>]</em>) – What iteration(s) this Node should be executed for.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>If this Node should be executed on this iteration.
bool: If this Node and recursive listeners should have updating their remaining listeners (and therefore their destruction) deferred.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nnsight.intervention.graph.graph.InterventionGraph.execute">
<span class="sig-name descname"><span class="pre">execute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grad</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">defer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">defer_start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/nnsight/intervention/graph/graph/#InterventionGraph.execute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnsight.intervention.graph.graph.InterventionGraph.execute" title="Link to this definition">#</a></dt>
<dd><p>Executes all <cite>Node`s (operations) in this `Graph</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>exception</strong> – If there is an exception during executing a <cite>Node</cite>. If so, we need to clean up the dependencies of <a href="#id1"><span class="problematic" id="id2">`</span></a>Node`s yet to be executed.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nnsight.intervention.graph.graph.InterventionGraph.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/nnsight/intervention/graph/graph/#InterventionGraph.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnsight.intervention.graph.graph.InterventionGraph.reset" title="Link to this definition">#</a></dt>
<dd><p>Resets the <cite>Graph</cite> to prepare for execution.
Simply resets all <cite>Node`s in the `Graph</cite>.</p>
</dd></dl>

</dd></dl>

<dl class="py class" id="module-nnsight.intervention.graph.node">
<dt class="sig sig-object py" id="nnsight.intervention.graph.node.InterventionNode">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">nnsight.intervention.graph.node.</span></span><span class="sig-name descname"><span class="pre">InterventionNode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fake_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnsight/intervention/graph/node/#InterventionNode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnsight.intervention.graph.node.InterventionNode" title="Link to this definition">#</a></dt>
<dd><p>This is the intervention extension of the base Node type.</p>
<p>It has a fake_value to see information about this Node’s future value before execution.
It adds additional functionality to Node.prepare_inputs to handle Tensors.</p>
<dl class="py method">
<dt class="sig sig-object py" id="nnsight.intervention.graph.node.InterventionNode.prepare_inputs">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">prepare_inputs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fake</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="../../_modules/nnsight/intervention/graph/node/#InterventionNode.prepare_inputs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnsight.intervention.graph.node.InterventionNode.prepare_inputs" title="Link to this definition">#</a></dt>
<dd><p>Override prepare_inputs to make sure</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong> (<em>Any</em>) – _description_</p></li>
<li><p><strong>device</strong> (<em>Optional</em><em>[</em><em>torch.device</em><em>]</em><em>, </em><em>optional</em>) – _description_. Defaults to None.</p></li>
<li><p><strong>fake</strong> (<em>bool</em><em>, </em><em>optional</em>) – _description_. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>_description_</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Any</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nnsight.intervention.graph.node.InterventionNode.update_dependencies">
<span class="sig-name descname"><span class="pre">update_dependencies</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnsight/intervention/graph/node/#InterventionNode.update_dependencies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnsight.intervention.graph.node.InterventionNode.update_dependencies" title="Link to this definition">#</a></dt>
<dd><p>Updates remaining_listeners of dependencies. If they are now redundant, destroy them.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="nnsight.intervention.graph.node.ValidatingInterventionNode">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">nnsight.intervention.graph.node.</span></span><span class="sig-name descname"><span class="pre">ValidatingInterventionNode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnsight/intervention/graph/node/#ValidatingInterventionNode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnsight.intervention.graph.node.ValidatingInterventionNode" title="Link to this definition">#</a></dt>
<dd><p>The ValidatingInterventionNode executes its target using the fake_values of all of its dependencies to calculate a new fake_value for this node.
Does not do this if the Node is detached from any graph, already has a fake_value (specified by whoever created the Node) or is a Protocol.</p>
</dd></dl>

<dl class="py class" id="module-nnsight.intervention.graph.proxy">
<dt class="sig sig-object py" id="nnsight.intervention.graph.proxy.InterventionProxy">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">nnsight.intervention.graph.proxy.</span></span><span class="sig-name descname"><span class="pre">InterventionProxy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#nnsight.intervention.graph.node.InterventionNode" title="nnsight.intervention.graph.node.InterventionNode"><span class="pre">InterventionNode</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnsight/intervention/graph/proxy/#InterventionProxy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnsight.intervention.graph.proxy.InterventionProxy" title="Link to this definition">#</a></dt>
<dd><dl class="py property">
<dt class="sig sig-object py" id="nnsight.intervention.graph.proxy.InterventionProxy.device">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">device</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Collection</span><span class="p"><span class="pre">[</span></span><span class="pre">device</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#nnsight.intervention.graph.proxy.InterventionProxy.device" title="Link to this definition">#</a></dt>
<dd><p>Property to retrieve the device of the traced proxy value or real value.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Proxy value device or collection of devices.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Union[torch.Size,Collection[torch.device]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="nnsight.intervention.graph.proxy.InterventionProxy.dtype">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dtype</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Collection</span><span class="p"><span class="pre">[</span></span><span class="pre">device</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#nnsight.intervention.graph.proxy.InterventionProxy.dtype" title="Link to this definition">#</a></dt>
<dd><p>Property to retrieve the dtype of the traced proxy value or real value.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Proxy value dtype or collection of dtypes.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Union[torch.Size,Collection[torch.dtype]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="nnsight.intervention.graph.proxy.InterventionProxy.grad">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">grad</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Self</span></em><a class="headerlink" href="#nnsight.intervention.graph.proxy.InterventionProxy.grad" title="Link to this definition">#</a></dt>
<dd><p>Calling denotes the user wishes to get the grad of proxy tensor and therefore we create a Proxy of that request.
Only generates a proxy the first time it is references otherwise return the already set one.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Grad proxy.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="../tracing/#nnsight.tracing.graph.proxy.Proxy" title="nnsight.tracing.graph.proxy.Proxy">Proxy</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="nnsight.intervention.graph.proxy.InterventionProxy.shape">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">shape</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Collection</span><span class="p"><span class="pre">[</span></span><span class="pre">Size</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#nnsight.intervention.graph.proxy.InterventionProxy.shape" title="Link to this definition">#</a></dt>
<dd><p>Property to retrieve the shape of the traced proxy value or real value.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Proxy value shape or collection of shapes.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Union[torch.Size,Collection[torch.Size]]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class" id="module-nnsight.intervention.base">
<dt class="sig sig-object py" id="nnsight.intervention.base.NNsight">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">nnsight.intervention.base.</span></span><span class="sig-name descname"><span class="pre">NNsight</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnsight/intervention/base/#NNsight"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnsight.intervention.base.NNsight" title="Link to this definition">#</a></dt>
<dd><p>Main class to be implemented as a wrapper for PyTorch models wishing to gain this package’s functionality.</p>
<p>Class Attributes:</p>
<blockquote>
<div><p>proxy_class (Type[InterventionProxy]): InterventionProxy like type to use as a Proxy for this Model’s inputs and outputs. Can have Model specific functionality added to a new sub-class.
__methods__ (Dict[str,str]): Mapping of method name, which will open up a .trace context, and the actual method name to execute / interleave with.</p>
<blockquote>
<div><p>For example lets say I had a method on my underlying ._model called <cite>.run</cite> that I wanted to have the NNsight interleaving functionality applied to.
I could define a method on my NNsight sub-class called <cite>._run</cite> which might look like:</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">_run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">inputs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

    <span class="n">inputs</span><span class="p">,</span> <span class="n">kwargs</span> <span class="o">=</span> <span class="n">some_preprocessing</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_model</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p>I could then have my __methods__ attribute look like <cite>__methods__ = {‘run’, ‘_run’}</cite>
This would allow me to do:</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">model</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="o">...</span><span class="p">):</span>

    <span class="n">output</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</pre></div>
</div>
</div></blockquote>
</div></blockquote>
</div></blockquote>
<dl class="py attribute">
<dt class="sig sig-object py" id="nnsight.intervention.base.NNsight._model">
<span class="sig-name descname"><span class="pre">_model</span></span><a class="headerlink" href="#nnsight.intervention.base.NNsight._model" title="Link to this definition">#</a></dt>
<dd><p>Underlying torch module.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.nn.Module</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="nnsight.intervention.base.NNsight._envoy">
<span class="sig-name descname"><span class="pre">_envoy</span></span><a class="headerlink" href="#nnsight.intervention.base.NNsight._envoy" title="Link to this definition">#</a></dt>
<dd><p>Envoy for underlying model.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#nnsight.intervention.envoy.Envoy" title="nnsight.intervention.envoy.Envoy">Envoy</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="nnsight.intervention.base.NNsight._session">
<span class="sig-name descname"><span class="pre">_session</span></span><a class="headerlink" href="#nnsight.intervention.base.NNsight._session" title="Link to this definition">#</a></dt>
<dd><p>Session object if in a Session.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#nnsight.intervention.contexts.session.Session" title="nnsight.intervention.contexts.session.Session">Session</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="nnsight.intervention.base.NNsight._default_graph">
<span class="sig-name descname"><span class="pre">_default_graph</span></span><a class="headerlink" href="#nnsight.intervention.base.NNsight._default_graph" title="Link to this definition">#</a></dt>
<dd><p>Intervention graph to start from when calling NNsight.trace. This is set via the editing context NNsight.edit.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../tracing/#nnsight.tracing.graph.graph.Graph" title="nnsight.tracing.graph.graph.Graph">Graph</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nnsight.intervention.base.NNsight.clear_edits">
<span class="sig-name descname"><span class="pre">clear_edits</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/nnsight/intervention/base/#NNsight.clear_edits"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnsight.intervention.base.NNsight.clear_edits" title="Link to this definition">#</a></dt>
<dd><p>Resets the default graph of this model.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nnsight.intervention.base.NNsight.edit">
<span class="sig-name descname"><span class="pre">edit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#nnsight.intervention.contexts.interleaving.InterleavingTracer" title="nnsight.intervention.contexts.interleaving.InterleavingTracer"><span class="pre">InterleavingTracer</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Any</span></span></span><a class="reference internal" href="../../_modules/nnsight/intervention/base/#NNsight.edit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnsight.intervention.base.NNsight.edit" title="Link to this definition">#</a></dt>
<dd><p>Create a trace context with an edit backend and apply a list of edits.</p>
<p>The edit backend sets a default graph on an NNsight model copy which is
run on future trace calls.</p>
<p>This operation is not inplace!</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>inplace</strong> (<em>bool</em>) – If True, makes edits in-place.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Either the Tracer used for tracing, or the raw output if trace is False.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Union[<a class="reference internal" href="../tracing/#nnsight.tracing.contexts.tracer.Tracer" title="nnsight.tracing.contexts.tracer.Tracer">Tracer</a>, Any]</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<p>from nnsight import LanguageModel</p>
<p>gpt2 = LanguageModel(“openai-community/gpt2)</p>
<dl class="simple">
<dt>class ComplexModule(torch.nn.Module):</dt><dd><dl class="simple">
<dt>def __init__(self):</dt><dd><p>super().__init__()
self.one = WrapperModule()</p>
</dd>
<dt>def forward(self, x):</dt><dd><p>return self.one(x)</p>
</dd>
</dl>
</dd>
</dl>
<p>l0 = gpt2.transformer.h[0]
l0.attachment = ComplexModule()</p>
<dl class="simple">
<dt>with gpt2.edit(“test”) as gpt2_edited:</dt><dd><p>acts = l0.output[0]
l0.output[0][:] = l0.attachment(acts, hook=True)</p>
</dd>
<dt>with gpt2.trace(MSG_prompt):</dt><dd><p>original = l0.output[0].clone().save()
l0.output[0][:] <a href="#id3"><span class="problematic" id="id4">*</span></a>= 0.0
original_output = gpt2.output.logits.save()</p>
</dd>
<dt>with gpt2_edited.trace(MSG_prompt):</dt><dd><p>one = l0.attachment.one.output.clone().save()
l0.attachment.output <a href="#id5"><span class="problematic" id="id6">*</span></a>= 0.0
edited_output = gpt2.output.logits.save()</p>
</dd>
</dl>
<p>print(original_output)
print(edited_output)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nnsight.intervention.base.NNsight.get">
<span class="sig-name descname"><span class="pre">get</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#nnsight.intervention.envoy.Envoy" title="nnsight.intervention.envoy.Envoy"><span class="pre">Envoy</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">InterventionProxyType</span></span></span><a class="reference internal" href="../../_modules/nnsight/intervention/base/#NNsight.get"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnsight.intervention.base.NNsight.get" title="Link to this definition">#</a></dt>
<dd><p>Gets the Envoy/Proxy via its path.</p>
<dl>
<dt>e.x:</dt><dd><p>model = nnsight.LanguageModel(“openai-community/gpt2”)</p>
<p>module = model.get(‘transformer.h.0.mlp’)</p>
<dl class="simple">
<dt>with model.trace(“Hello”):</dt><dd><p>value = model.get(‘transformer.h.0.mlp.output’).save()</p>
</dd>
</dl>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>path</strong> (<em>str</em>) – ‘.’ separated path.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Fetched Envoy/Proxy</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Union[<a class="reference internal" href="#nnsight.intervention.envoy.Envoy" title="nnsight.intervention.envoy.Envoy">Envoy</a>, InterventionProxyType]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nnsight.intervention.base.NNsight.interleave">
<span class="sig-name descname"><span class="pre">interleave</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">interleaver</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#nnsight.intervention.interleaver.Interleaver" title="nnsight.intervention.interleaver.Interleaver"><span class="pre">Interleaver</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="../../_modules/nnsight/intervention/base/#NNsight.interleave"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnsight.intervention.base.NNsight.interleave" title="Link to this definition">#</a></dt>
<dd><p>This is the point in nnsight where we finally execute the model and interleave our custom logic.
Simply resolves the function and executes it given some input within the Intreleaver context.
This method is on here vs on the Interleaver because some models might want to define custom interleaving behavior. For example loading real model weights before execution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>interleaver</strong> (<a class="reference internal" href="#nnsight.intervention.interleaver.Interleaver" title="nnsight.intervention.interleaver.Interleaver"><em>Interleaver</em></a>) – Interleaver.</p></li>
<li><p><strong>fn</strong> (<em>Optional</em><em>[</em><em>Union</em><em>[</em><em>Callable</em><em>, </em><em>str</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – Function to interleave with. Defaults to None and therefore NNsight._execute.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>_description_</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Any</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="nnsight.intervention.base.NNsight.proxy_class">
<span class="sig-name descname"><span class="pre">proxy_class</span></span><a class="headerlink" href="#nnsight.intervention.base.NNsight.proxy_class" title="Link to this definition">#</a></dt>
<dd><p>alias of <a class="reference internal" href="#nnsight.intervention.graph.proxy.InterventionProxy" title="nnsight.intervention.graph.proxy.InterventionProxy"><code class="xref py py-class docutils literal notranslate"><span class="pre">InterventionProxy</span></code></a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nnsight.intervention.base.NNsight.scan">
<span class="sig-name descname"><span class="pre">scan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#nnsight.intervention.contexts.interleaving.InterleavingTracer" title="nnsight.intervention.contexts.interleaving.InterleavingTracer"><span class="pre">InterleavingTracer</span></a></span></span><a class="reference internal" href="../../_modules/nnsight/intervention/base/#NNsight.scan"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnsight.intervention.base.NNsight.scan" title="Link to this definition">#</a></dt>
<dd><p>Context just to populate fake tensor proxy values using scan and validate.
Useful when looking for just the shapes of future tensors</p>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">model</span><span class="o">.</span><span class="n">scan</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">):</span>

    <span class="n">dim</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">module</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tracer context with Noop backend.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="../tracing/#nnsight.tracing.contexts.tracer.Tracer" title="nnsight.tracing.contexts.tracer.Tracer">Tracer</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nnsight.intervention.base.NNsight.session">
<span class="sig-name descname"><span class="pre">session</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">backend</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Backend</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#nnsight.intervention.contexts.session.Session" title="nnsight.intervention.contexts.session.Session"><span class="pre">Session</span></a></span></span><a class="reference internal" href="../../_modules/nnsight/intervention/base/#NNsight.session"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnsight.intervention.base.NNsight.session" title="Link to this definition">#</a></dt>
<dd><p>Create a session context using a Session.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>backend</strong> (<em>Backend</em>) – Backend for this Session object.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Session.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#nnsight.intervention.contexts.session.Session" title="nnsight.intervention.contexts.session.Session">Session</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nnsight.intervention.base.NNsight.to">
<span class="sig-name descname"><span class="pre">to</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="../../_modules/nnsight/intervention/base/#NNsight.to"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnsight.intervention.base.NNsight.to" title="Link to this definition">#</a></dt>
<dd><p>Override torch.nn.Module.to so this returns the NNSight model, not the underlying module when doing: model = model.to(…)</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Envoy.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#nnsight.intervention.envoy.Envoy" title="nnsight.intervention.envoy.Envoy">Envoy</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nnsight.intervention.base.NNsight.trace">
<span class="sig-name descname"><span class="pre">trace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trace</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scan</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">invoker_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backend</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Backend</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#nnsight.intervention.contexts.interleaving.InterleavingTracer" title="nnsight.intervention.contexts.interleaving.InterleavingTracer"><span class="pre">InterleavingTracer</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Any</span></span></span><a class="reference internal" href="../../_modules/nnsight/intervention/base/#NNsight.trace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnsight.intervention.base.NNsight.trace" title="Link to this definition">#</a></dt>
<dd><p>Entrypoint into the tracing and interleaving functionality nnsight provides.</p>
<p>In short, allows access to the future inputs and outputs of modules in order to trace what operations you would like to perform on them.
This can be as simple as accessing and saving activations for inspection, or as complicated as transforming the activations and gradients in a forward pass over multiple inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong> (<em>tuple</em><em>[</em><em>Any</em><em>]</em>) – When positional arguments are provided directly to .trace, we assume there is only one Invoker and therefore
immediately create an enter an Invoker.</p></li>
<li><p><strong>trace</strong> (<em>bool</em><em>, </em><em>optional</em>) – If to open a tracing context. Otherwise immediately run the model and return the raw output. Defaults to True.</p></li>
<li><p><strong>scan</strong> (<em>bool</em>) – Exposed invoker kwarg to scan for the provided input. No effect if there is no input.</p></li>
<li><p><strong>method</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em>) – String name of method to interleave with. Defaults to None and therefore NNsight._execute</p></li>
<li><p><strong>invoker_kwargs</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em><em>, </em><em>optional</em>) – Keyword arguments to pass to Invoker initialization, and then downstream to the model’s .prepare_inputs(…) method. Used when giving input directly to <cite>.trace(…)</cite>. Defaults to None.</p></li>
<li><p><strong>kwargs</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) – Keyword arguments passed to Tracer initialization, and then downstream to the model’s execution method.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If trace is False and no inputs were provided (nothing to run with)</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Either the Tracer used for tracing, or the raw output if trace is False.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Union[<a class="reference internal" href="../tracing/#nnsight.tracing.contexts.tracer.Tracer" title="nnsight.tracing.contexts.tracer.Tracer">Tracer</a>, Any]</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>There are a few ways you can use <code class="docutils literal notranslate"><span class="pre">.trace(...)</span></code> depending in your use case.</p>
<p>Lets use this extremely basic model for our examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">OrderedDict</span>

<span class="n">input_size</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">hidden_dims</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">output_size</span> <span class="o">=</span> <span class="mi">2</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span><span class="n">OrderedDict</span><span class="p">([</span>
    <span class="p">(</span><span class="s1">&#39;layer1&#39;</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">input_size</span><span class="p">,</span> <span class="n">hidden_dims</span><span class="p">)),</span>
    <span class="p">(</span><span class="s1">&#39;sigma1&#39;</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Sigmoid</span><span class="p">()),</span>
    <span class="p">(</span><span class="s1">&#39;layer2&#39;</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">hidden_dims</span><span class="p">,</span> <span class="n">output_size</span><span class="p">)),</span>
    <span class="p">(</span><span class="s1">&#39;sigma2&#39;</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Sigmoid</span><span class="p">()),</span>
<span class="p">]))</span>

<span class="n">example_input</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">input_size</span><span class="p">))</span>
</pre></div>
</div>
<p>The first example has us running the model with a single example input, and saving the input and output of ‘layer2’ as well as the final output using the tracing context.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">nnsight</span><span class="w"> </span><span class="kn">import</span> <span class="n">NNsight</span>

<span class="k">with</span> <span class="n">NNsight</span><span class="p">(</span><span class="n">model</span><span class="p">)</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">example_input</span><span class="p">)</span> <span class="k">as</span> <span class="n">model</span><span class="p">:</span>

    <span class="n">l2_input</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">layer2</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
    <span class="n">l2_output</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">layer2</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>

    <span class="n">output</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">l2_input</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">l2_output</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
</pre></div>
</div>
<p>The second example allows us to divide up multiple inputs into one batch, and scope an inner invoker context to each one.
We indicate this simply by not passing and positional inputs into <cite>.trace(…)</cite>. The Tracer object then expects you to enter each input via <cite>Tracer.invoke(…)</cite></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">example_input2</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">input_size</span><span class="p">))</span>

<span class="k">with</span> <span class="n">NNsight</span><span class="p">(</span><span class="n">model</span><span class="p">)</span><span class="o">.</span><span class="n">trace</span><span class="p">()</span> <span class="k">as</span> <span class="n">model</span><span class="p">:</span>

    <span class="k">with</span> <span class="n">model</span><span class="o">.</span><span class="n">invoke</span><span class="p">(</span><span class="n">example_input</span><span class="p">):</span>

        <span class="n">output1</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>

    <span class="k">with</span> <span class="n">model</span><span class="o">.</span><span class="n">invoke</span><span class="p">(</span><span class="n">example_input2</span><span class="p">):</span>

        <span class="n">output2</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">output1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">output2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class" id="module-nnsight.intervention.envoy">
<dt class="sig sig-object py" id="nnsight.intervention.envoy.Envoy">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">nnsight.intervention.envoy.</span></span><span class="sig-name descname"><span class="pre">Envoy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">module</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">module_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alias_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnsight/intervention/envoy/#Envoy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnsight.intervention.envoy.Envoy" title="Link to this definition">#</a></dt>
<dd><p>Envoy objects act as proxies for torch modules themselves within a model’s module tree in order to add nnsight functionality.
Proxies of the underlying module’s output and input are accessed by <cite>.output</cite> and <cite>.input</cite> respectively.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="nnsight.intervention.envoy.Envoy.path">
<span class="sig-name descname"><span class="pre">path</span></span><a class="headerlink" href="#nnsight.intervention.envoy.Envoy.path" title="Link to this definition">#</a></dt>
<dd><p>String representing the attribute path of this Envoy’s module relative the the root model. Separated by ‘.’ e.x (‘.transformer.h.0.mlp’).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="nnsight.intervention.envoy.Envoy.output">
<span class="sig-name descname"><span class="pre">output</span></span><a class="headerlink" href="#nnsight.intervention.envoy.Envoy.output" title="Link to this definition">#</a></dt>
<dd><p>Proxy object representing the output of this Envoy’s module. Reset on forward pass.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nnsight.intervention.InterventionProxy</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="nnsight.intervention.envoy.Envoy.inputs">
<span class="sig-name descname"><span class="pre">inputs</span></span><a class="headerlink" href="#nnsight.intervention.envoy.Envoy.inputs" title="Link to this definition">#</a></dt>
<dd><p>Proxy object representing the inputs of this Envoy’s module. Proxy is in the form of (Tuple[Tuple[&lt;Positional arg&gt;], Dict[str, &lt;Keyword arg&gt;]])Reset on forward pass.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nnsight.intervention.InterventionProxy</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="nnsight.intervention.envoy.Envoy.input">
<span class="sig-name descname"><span class="pre">input</span></span><a class="headerlink" href="#nnsight.intervention.envoy.Envoy.input" title="Link to this definition">#</a></dt>
<dd><p>Alias for the first positional Proxy input i.e Envoy.inputs[0][0]</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nnsight.intervention.InterventionProxy</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="nnsight.intervention.envoy.Envoy.iter">
<span class="sig-name descname"><span class="pre">iter</span></span><a class="headerlink" href="#nnsight.intervention.envoy.Envoy.iter" title="Link to this definition">#</a></dt>
<dd><p>Iterator object allowing selection of specific .input and .output iterations of this Envoy.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nnsight.envoy.EnvoyIterator</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="nnsight.intervention.envoy.Envoy._module">
<span class="sig-name descname"><span class="pre">_module</span></span><a class="headerlink" href="#nnsight.intervention.envoy.Envoy._module" title="Link to this definition">#</a></dt>
<dd><p>Underlying torch module.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.nn.Module</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="nnsight.intervention.envoy.Envoy._children">
<span class="sig-name descname"><span class="pre">_children</span></span><a class="headerlink" href="#nnsight.intervention.envoy.Envoy._children" title="Link to this definition">#</a></dt>
<dd><p>Immediate Envoy children of this Envoy.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[<a class="reference internal" href="#nnsight.intervention.envoy.Envoy" title="nnsight.intervention.envoy.Envoy">Envoy</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="nnsight.intervention.envoy.Envoy._fake_outputs">
<span class="sig-name descname"><span class="pre">_fake_outputs</span></span><a class="headerlink" href="#nnsight.intervention.envoy.Envoy._fake_outputs" title="Link to this definition">#</a></dt>
<dd><p>List of ‘meta’ tensors built from the outputs most recent _scan. Is list as there can be multiple shapes for a module called more than once.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[torch.Tensor]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="nnsight.intervention.envoy.Envoy._fake_inputs">
<span class="sig-name descname"><span class="pre">_fake_inputs</span></span><a class="headerlink" href="#nnsight.intervention.envoy.Envoy._fake_inputs" title="Link to this definition">#</a></dt>
<dd><p>List of ‘meta’ tensors built from the inputs most recent _scan. Is list as there can be multiple shapes for a module called more than once.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[torch.Tensor]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="nnsight.intervention.envoy.Envoy._rename">
<span class="sig-name descname"><span class="pre">_rename</span></span><a class="headerlink" href="#nnsight.intervention.envoy.Envoy._rename" title="Link to this definition">#</a></dt>
<dd><p>Optional mapping of (old name -&gt; new name).
For example to rename all gpt ‘attn’ modules to ‘attention’ you would: rename={r”attn”: “attention”}
Not this does not actually change the underlying module names, just how you access its envoy. Renaming will replace Envoy.path but Envoy._path represents the pre-renamed true attribute path.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[Dict[str,str]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="nnsight.intervention.envoy.Envoy._tracer">
<span class="sig-name descname"><span class="pre">_tracer</span></span><a class="headerlink" href="#nnsight.intervention.envoy.Envoy._tracer" title="Link to this definition">#</a></dt>
<dd><p>Object which adds this Envoy’s module’s output and input proxies to an intervention graph. Must be set on Envoys objects manually by the Tracer.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nnsight.context.Tracer.Tracer</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nnsight.intervention.envoy.Envoy.all">
<span class="sig-name descname"><span class="pre">all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">propagate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#nnsight.intervention.envoy.Envoy" title="nnsight.intervention.envoy.Envoy"><span class="pre">Envoy</span></a></span></span><a class="reference internal" href="../../_modules/nnsight/intervention/envoy/#Envoy.all"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnsight.intervention.envoy.Envoy.all" title="Link to this definition">#</a></dt>
<dd><p>By default, this modules inputs and outputs only refer to the first time its called. Use <a href="#id7"><span class="problematic" id="id8">`</span></a>.all()`to have .input and .output refer to all iterations.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Self.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#nnsight.intervention.envoy.Envoy" title="nnsight.intervention.envoy.Envoy">Envoy</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="id0">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">input</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">InterventionProxyType</span></em><a class="headerlink" href="#id0" title="Link to this definition">#</a></dt>
<dd><p>Getting the first positional argument input of the model’s module.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Input proxy.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#nnsight.intervention.graph.proxy.InterventionProxy" title="nnsight.intervention.graph.proxy.InterventionProxy">InterventionProxy</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="id9">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">inputs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">InterventionProxyType</span></em><a class="headerlink" href="#id9" title="Link to this definition">#</a></dt>
<dd><p>Calling denotes the user wishes to get the input of the underlying module and therefore we create a Proxy of that request.
Only generates a proxy the first time it is references otherwise return the already set one.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Input proxy.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#nnsight.intervention.graph.proxy.InterventionProxy" title="nnsight.intervention.graph.proxy.InterventionProxy">InterventionProxy</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nnsight.intervention.envoy.Envoy.modules">
<span class="sig-name descname"><span class="pre">modules</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">include_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#nnsight.intervention.envoy.Envoy" title="nnsight.intervention.envoy.Envoy"><span class="pre">Envoy</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">envoys</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#nnsight.intervention.envoy.Envoy" title="nnsight.intervention.envoy.Envoy"><span class="pre">Envoy</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/nnsight/intervention/envoy/#Envoy.modules"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnsight.intervention.envoy.Envoy.modules" title="Link to this definition">#</a></dt>
<dd><p>Returns all Envoys in the Envoy tree.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>include_fn</strong> (<em>Callable</em><em>, </em><em>optional</em>) – Optional function to be ran against all Envoys to check if they should be included in the final collection of Envoys. Defaults to None.</p></li>
<li><p><strong>names</strong> (<em>bool</em><em>, </em><em>optional</em>) – If to include the name/module_path of returned Envoys along with the Envoy itself. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Included Envoys</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[<a class="reference internal" href="#nnsight.intervention.envoy.Envoy" title="nnsight.intervention.envoy.Envoy">Envoy</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nnsight.intervention.envoy.Envoy.named_modules">
<span class="sig-name descname"><span class="pre">named_modules</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#nnsight.intervention.envoy.Envoy" title="nnsight.intervention.envoy.Envoy"><span class="pre">Envoy</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/nnsight/intervention/envoy/#Envoy.named_modules"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnsight.intervention.envoy.Envoy.named_modules" title="Link to this definition">#</a></dt>
<dd><p>Returns all Envoys in the Envoy tree along with their name/module_path.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>include_fn</strong> (<em>Callable</em><em>, </em><em>optional</em>) – Optional function to be ran against all Envoys to check if they should be included in the final collection of Envoys. Defaults to None.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Included Envoys and their names/module_paths.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[Tuple[str, <a class="reference internal" href="#nnsight.intervention.envoy.Envoy" title="nnsight.intervention.envoy.Envoy">Envoy</a>]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nnsight.intervention.envoy.Envoy.next">
<span class="sig-name descname"><span class="pre">next</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">increment</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#nnsight.intervention.envoy.Envoy" title="nnsight.intervention.envoy.Envoy"><span class="pre">Envoy</span></a></span></span><a class="reference internal" href="../../_modules/nnsight/intervention/envoy/#Envoy.next"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnsight.intervention.envoy.Envoy.next" title="Link to this definition">#</a></dt>
<dd><p>By default, this modules inputs and outputs only refer to the first time its called. Use <a href="#id10"><span class="problematic" id="id11">`</span></a>.next()`to select which iteration .input an .output refer to.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>increment</strong> (<em>int</em><em>, </em><em>optional</em>) – How many iterations to jump. Defaults to 1.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Self.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#nnsight.intervention.envoy.Envoy" title="nnsight.intervention.envoy.Envoy">Envoy</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="id12">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">output</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">InterventionProxyType</span></em><a class="headerlink" href="#id12" title="Link to this definition">#</a></dt>
<dd><p>Calling denotes the user wishes to get the output of the underlying module and therefore we create a Proxy of that request.
Only generates a proxy the first time it is references otherwise return the already set one.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Output proxy.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#nnsight.intervention.graph.proxy.InterventionProxy" title="nnsight.intervention.graph.proxy.InterventionProxy">InterventionProxy</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nnsight.intervention.envoy.Envoy.to">
<span class="sig-name descname"><span class="pre">to</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#nnsight.intervention.envoy.Envoy" title="nnsight.intervention.envoy.Envoy"><span class="pre">Envoy</span></a></span></span><a class="reference internal" href="../../_modules/nnsight/intervention/envoy/#Envoy.to"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnsight.intervention.envoy.Envoy.to" title="Link to this definition">#</a></dt>
<dd><p>Override torch.nn.Module.to so this returns the Envoy, not the underlying module when doing: model = model.to(…)</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Envoy.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#nnsight.intervention.envoy.Envoy" title="nnsight.intervention.envoy.Envoy">Envoy</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="nnsight.intervention.envoy.IterationEnvoy">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">nnsight.intervention.envoy.</span></span><span class="sig-name descname"><span class="pre">IterationEnvoy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">envoy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#nnsight.intervention.envoy.Envoy" title="nnsight.intervention.envoy.Envoy"><span class="pre">Envoy</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnsight/intervention/envoy/#IterationEnvoy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnsight.intervention.envoy.IterationEnvoy" title="Link to this definition">#</a></dt>
<dd><dl class="py property">
<dt class="sig sig-object py" id="nnsight.intervention.envoy.IterationEnvoy.input">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">input</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">InterventionProxyType</span></em><a class="headerlink" href="#nnsight.intervention.envoy.IterationEnvoy.input" title="Link to this definition">#</a></dt>
<dd><p>Getting the first positional argument input of the model’s module.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Input proxy.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#nnsight.intervention.graph.proxy.InterventionProxy" title="nnsight.intervention.graph.proxy.InterventionProxy">InterventionProxy</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="nnsight.intervention.envoy.IterationEnvoy.output">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">output</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">InterventionProxyType</span></em><a class="headerlink" href="#nnsight.intervention.envoy.IterationEnvoy.output" title="Link to this definition">#</a></dt>
<dd><p>Calling denotes the user wishes to get the output of the underlying module and therefore we create a Proxy of that request.
Only generates a proxy the first time it is references otherwise return the already set one.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Output proxy.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#nnsight.intervention.graph.proxy.InterventionProxy" title="nnsight.intervention.graph.proxy.InterventionProxy">InterventionProxy</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class" id="module-nnsight.intervention.interleaver">
<dt class="sig sig-object py" id="nnsight.intervention.interleaver.Interleaver">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">nnsight.intervention.interleaver.</span></span><span class="sig-name descname"><span class="pre">Interleaver</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">graph</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#nnsight.intervention.graph.graph.InterventionGraph" title="nnsight.intervention.graph.graph.InterventionGraph"><span class="pre">InterventionGraph</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_groups</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_hook</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_hook</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnsight/intervention/interleaver/#Interleaver"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnsight.intervention.interleaver.Interleaver" title="Link to this definition">#</a></dt>
<dd><p>The Interleaver is responsible for executing a function involving a PyTorch model alongside a user’s custom functionality
(represented by an <cite>InterventionGraph</cite>). This is called interleaving.</p>
<p>The <cite>InterventionGraph</cite> has information about which components (modules) of the model the user’s custom logic will interact with.
As the <cite>Interleaver</cite> is a context, entering it adds the appropriate hooks to these components which act as a bridge between the model’s
original computation graph and the <cite>InterventionGraph</cite>. Exiting the <cite>Interleaver</cite> removes these hooks.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="nnsight.intervention.interleaver.Interleaver.graph">
<span class="sig-name descname"><span class="pre">graph</span></span><a class="headerlink" href="#nnsight.intervention.interleaver.Interleaver.graph" title="Link to this definition">#</a></dt>
<dd><p>The computation graph representing the user’s custom intervention logic.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#nnsight.intervention.graph.graph.InterventionGraph" title="nnsight.intervention.graph.graph.InterventionGraph">InterventionGraph</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="nnsight.intervention.interleaver.Interleaver.batch_groups">
<span class="sig-name descname"><span class="pre">batch_groups</span></span><a class="headerlink" href="#nnsight.intervention.interleaver.Interleaver.batch_groups" title="Link to this definition">#</a></dt>
<dd><p>A batch group is a section of tensor values related to a given intervention.
They are a tuple of (batch_start, batch_length). So if batch group 0 was (0, 4) it means it starts at index 0 and goes until index 3.
The batch index is assumed to be the first dimension of all Tensors.
InterventionProtocol Nodes know which batch group they are a part of in their arguments. That value is the index into the batch_groups.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[List[Tuple[int, int]]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="nnsight.intervention.interleaver.Interleaver.input_hook">
<span class="sig-name descname"><span class="pre">input_hook</span></span><a class="headerlink" href="#nnsight.intervention.interleaver.Interleaver.input_hook" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[Callable]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="nnsight.intervention.interleaver.Interleaver.output_hook">
<span class="sig-name descname"><span class="pre">output_hook</span></span><a class="headerlink" href="#nnsight.intervention.interleaver.Interleaver.output_hook" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[Callable]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="nnsight.intervention.interleaver.Interleaver.batch_size">
<span class="sig-name descname"><span class="pre">batch_size</span></span><a class="headerlink" href="#nnsight.intervention.interleaver.Interleaver.batch_size" title="Link to this definition">#</a></dt>
<dd><p>i.e If a Tensor’s first dimension isn’t batch_size, we dont need to narrow it to convert it for its batch_group.
Defaults to None and therefore the sum of the last batch_group.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[int]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


                </article>
              
              
              
              
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.protocols.entrypoint.EntryPoint"><code class="docutils literal notranslate"><span class="pre">EntryPoint</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.protocols.grad.GradProtocol"><code class="docutils literal notranslate"><span class="pre">GradProtocol</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.protocols.grad.GradProtocol.style"><code class="docutils literal notranslate"><span class="pre">GradProtocol.style()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.protocols.intervention.InterventionProtocol"><code class="docutils literal notranslate"><span class="pre">InterventionProtocol</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.protocols.intervention.InterventionProtocol.intervene"><code class="docutils literal notranslate"><span class="pre">InterventionProtocol.intervene()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.protocols.intervention.InterventionProtocol.style"><code class="docutils literal notranslate"><span class="pre">InterventionProtocol.style()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.protocols.module.ApplyModuleProtocol"><code class="docutils literal notranslate"><span class="pre">ApplyModuleProtocol</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.protocols.module.ApplyModuleProtocol.add"><code class="docutils literal notranslate"><span class="pre">ApplyModuleProtocol.add()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.protocols.module.ApplyModuleProtocol.execute"><code class="docutils literal notranslate"><span class="pre">ApplyModuleProtocol.execute()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.protocols.module.ApplyModuleProtocol.style"><code class="docutils literal notranslate"><span class="pre">ApplyModuleProtocol.style()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.contexts.editing.EditingTracer"><code class="docutils literal notranslate"><span class="pre">EditingTracer</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.contexts.globals.GlobalInterventionTracingContext"><code class="docutils literal notranslate"><span class="pre">GlobalInterventionTracingContext</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.contexts.interleaving.InterleavingTracer"><code class="docutils literal notranslate"><span class="pre">InterleavingTracer</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.contexts.interleaving.InterleavingTracer._model"><code class="docutils literal notranslate"><span class="pre">InterleavingTracer._model</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.contexts.interleaving.InterleavingTracer.invoker"><code class="docutils literal notranslate"><span class="pre">InterleavingTracer.invoker</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.contexts.interleaving.InterleavingTracer.args"><code class="docutils literal notranslate"><span class="pre">InterleavingTracer.args</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.contexts.interleaving.InterleavingTracer.kwargs"><code class="docutils literal notranslate"><span class="pre">InterleavingTracer.kwargs</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.contexts.interleaving.InterleavingTracer.invoke"><code class="docutils literal notranslate"><span class="pre">InterleavingTracer.invoke()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.contexts.invoker.Invoker"><code class="docutils literal notranslate"><span class="pre">Invoker</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.contexts.invoker.Invoker.tracer"><code class="docutils literal notranslate"><span class="pre">Invoker.tracer</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.contexts.invoker.Invoker.inputs"><code class="docutils literal notranslate"><span class="pre">Invoker.inputs</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.contexts.invoker.Invoker.scan"><code class="docutils literal notranslate"><span class="pre">Invoker.scan</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.contexts.invoker.Invoker.kwargs"><code class="docutils literal notranslate"><span class="pre">Invoker.kwargs</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.contexts.invoker.Invoker.scanning"><code class="docutils literal notranslate"><span class="pre">Invoker.scanning</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.contexts.local.LocalContext"><code class="docutils literal notranslate"><span class="pre">LocalContext</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.contexts.local.RemoteContext"><code class="docutils literal notranslate"><span class="pre">RemoteContext</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.contexts.session.Session"><code class="docutils literal notranslate"><span class="pre">Session</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.contexts.tracer.InterventionTracer"><code class="docutils literal notranslate"><span class="pre">InterventionTracer</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.contexts.tracer.InterventionTracer.style"><code class="docutils literal notranslate"><span class="pre">InterventionTracer.style()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.backends.editing.EditingBackend"><code class="docutils literal notranslate"><span class="pre">EditingBackend</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.backends.remote.RemoteBackend"><code class="docutils literal notranslate"><span class="pre">RemoteBackend</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.backends.remote.RemoteBackend.url"><code class="docutils literal notranslate"><span class="pre">RemoteBackend.url</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.backends.remote.RemoteBackend.blocking_request"><code class="docutils literal notranslate"><span class="pre">RemoteBackend.blocking_request()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.backends.remote.RemoteBackend.get_response"><code class="docutils literal notranslate"><span class="pre">RemoteBackend.get_response()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.backends.remote.RemoteBackend.handle_response"><code class="docutils literal notranslate"><span class="pre">RemoteBackend.handle_response()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.backends.remote.RemoteBackend.non_blocking_request"><code class="docutils literal notranslate"><span class="pre">RemoteBackend.non_blocking_request()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.backends.remote.RemoteBackend.stream_send"><code class="docutils literal notranslate"><span class="pre">RemoteBackend.stream_send()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.backends.remote.RemoteBackend.submit_request"><code class="docutils literal notranslate"><span class="pre">RemoteBackend.submit_request()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.graph.graph.InterventionGraph"><code class="docutils literal notranslate"><span class="pre">InterventionGraph</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.graph.graph.InterventionGraph.model"><code class="docutils literal notranslate"><span class="pre">InterventionGraph.model</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.graph.graph.InterventionGraph.interventions"><code class="docutils literal notranslate"><span class="pre">InterventionGraph.interventions</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.graph.graph.InterventionGraph.grad_subgraph"><code class="docutils literal notranslate"><span class="pre">InterventionGraph.grad_subgraph</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.graph.graph.InterventionGraph.compiled"><code class="docutils literal notranslate"><span class="pre">InterventionGraph.compiled</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.graph.graph.InterventionGraph.call_counter"><code class="docutils literal notranslate"><span class="pre">InterventionGraph.call_counter</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.graph.graph.InterventionGraph.deferred"><code class="docutils literal notranslate"><span class="pre">InterventionGraph.deferred</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.graph.graph.InterventionGraph.clean"><code class="docutils literal notranslate"><span class="pre">InterventionGraph.clean()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.graph.graph.InterventionGraph.cleanup"><code class="docutils literal notranslate"><span class="pre">InterventionGraph.cleanup()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.graph.graph.InterventionGraph.copy"><code class="docutils literal notranslate"><span class="pre">InterventionGraph.copy()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.graph.graph.InterventionGraph.count"><code class="docutils literal notranslate"><span class="pre">InterventionGraph.count()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.graph.graph.InterventionGraph.execute"><code class="docutils literal notranslate"><span class="pre">InterventionGraph.execute()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.graph.graph.InterventionGraph.reset"><code class="docutils literal notranslate"><span class="pre">InterventionGraph.reset()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.graph.node.InterventionNode"><code class="docutils literal notranslate"><span class="pre">InterventionNode</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.graph.node.InterventionNode.prepare_inputs"><code class="docutils literal notranslate"><span class="pre">InterventionNode.prepare_inputs()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.graph.node.InterventionNode.update_dependencies"><code class="docutils literal notranslate"><span class="pre">InterventionNode.update_dependencies()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.graph.node.ValidatingInterventionNode"><code class="docutils literal notranslate"><span class="pre">ValidatingInterventionNode</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.graph.proxy.InterventionProxy"><code class="docutils literal notranslate"><span class="pre">InterventionProxy</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.graph.proxy.InterventionProxy.device"><code class="docutils literal notranslate"><span class="pre">InterventionProxy.device</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.graph.proxy.InterventionProxy.dtype"><code class="docutils literal notranslate"><span class="pre">InterventionProxy.dtype</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.graph.proxy.InterventionProxy.grad"><code class="docutils literal notranslate"><span class="pre">InterventionProxy.grad</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.graph.proxy.InterventionProxy.shape"><code class="docutils literal notranslate"><span class="pre">InterventionProxy.shape</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.base.NNsight"><code class="docutils literal notranslate"><span class="pre">NNsight</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.base.NNsight._model"><code class="docutils literal notranslate"><span class="pre">NNsight._model</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.base.NNsight._envoy"><code class="docutils literal notranslate"><span class="pre">NNsight._envoy</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.base.NNsight._session"><code class="docutils literal notranslate"><span class="pre">NNsight._session</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.base.NNsight._default_graph"><code class="docutils literal notranslate"><span class="pre">NNsight._default_graph</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.base.NNsight.clear_edits"><code class="docutils literal notranslate"><span class="pre">NNsight.clear_edits()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.base.NNsight.edit"><code class="docutils literal notranslate"><span class="pre">NNsight.edit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.base.NNsight.get"><code class="docutils literal notranslate"><span class="pre">NNsight.get()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.base.NNsight.interleave"><code class="docutils literal notranslate"><span class="pre">NNsight.interleave()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.base.NNsight.proxy_class"><code class="docutils literal notranslate"><span class="pre">NNsight.proxy_class</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.base.NNsight.scan"><code class="docutils literal notranslate"><span class="pre">NNsight.scan()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.base.NNsight.session"><code class="docutils literal notranslate"><span class="pre">NNsight.session()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.base.NNsight.to"><code class="docutils literal notranslate"><span class="pre">NNsight.to()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.base.NNsight.trace"><code class="docutils literal notranslate"><span class="pre">NNsight.trace()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.envoy.Envoy"><code class="docutils literal notranslate"><span class="pre">Envoy</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.envoy.Envoy.path"><code class="docutils literal notranslate"><span class="pre">Envoy.path</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.envoy.Envoy.output"><code class="docutils literal notranslate"><span class="pre">Envoy.output</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.envoy.Envoy.inputs"><code class="docutils literal notranslate"><span class="pre">Envoy.inputs</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.envoy.Envoy.input"><code class="docutils literal notranslate"><span class="pre">Envoy.input</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.envoy.Envoy.iter"><code class="docutils literal notranslate"><span class="pre">Envoy.iter</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.envoy.Envoy._module"><code class="docutils literal notranslate"><span class="pre">Envoy._module</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.envoy.Envoy._children"><code class="docutils literal notranslate"><span class="pre">Envoy._children</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.envoy.Envoy._fake_outputs"><code class="docutils literal notranslate"><span class="pre">Envoy._fake_outputs</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.envoy.Envoy._fake_inputs"><code class="docutils literal notranslate"><span class="pre">Envoy._fake_inputs</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.envoy.Envoy._rename"><code class="docutils literal notranslate"><span class="pre">Envoy._rename</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.envoy.Envoy._tracer"><code class="docutils literal notranslate"><span class="pre">Envoy._tracer</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.envoy.Envoy.all"><code class="docutils literal notranslate"><span class="pre">Envoy.all()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id0"><code class="docutils literal notranslate"><span class="pre">Envoy.input</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id9"><code class="docutils literal notranslate"><span class="pre">Envoy.inputs</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.envoy.Envoy.modules"><code class="docutils literal notranslate"><span class="pre">Envoy.modules()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.envoy.Envoy.named_modules"><code class="docutils literal notranslate"><span class="pre">Envoy.named_modules()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.envoy.Envoy.next"><code class="docutils literal notranslate"><span class="pre">Envoy.next()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id12"><code class="docutils literal notranslate"><span class="pre">Envoy.output</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.envoy.Envoy.to"><code class="docutils literal notranslate"><span class="pre">Envoy.to()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.envoy.IterationEnvoy"><code class="docutils literal notranslate"><span class="pre">IterationEnvoy</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.envoy.IterationEnvoy.input"><code class="docutils literal notranslate"><span class="pre">IterationEnvoy.input</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.envoy.IterationEnvoy.output"><code class="docutils literal notranslate"><span class="pre">IterationEnvoy.output</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.interleaver.Interleaver"><code class="docutils literal notranslate"><span class="pre">Interleaver</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.interleaver.Interleaver.graph"><code class="docutils literal notranslate"><span class="pre">Interleaver.graph</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.interleaver.Interleaver.batch_groups"><code class="docutils literal notranslate"><span class="pre">Interleaver.batch_groups</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.interleaver.Interleaver.input_hook"><code class="docutils literal notranslate"><span class="pre">Interleaver.input_hook</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.interleaver.Interleaver.output_hook"><code class="docutils literal notranslate"><span class="pre">Interleaver.output_hook</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nnsight.intervention.interleaver.Interleaver.batch_size"><code class="docutils literal notranslate"><span class="pre">Interleaver.batch_size</span></code></a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2025 NDIF.
      <br/>
    
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>